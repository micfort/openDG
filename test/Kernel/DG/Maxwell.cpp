//////////////////////////////////////////////////////////////////////////
// This file is part of openPSTD.                                       //
//                                                                      //
// openPSTD is free software: you can redistribute it and/or modify     //
// it under the terms of the GNU General Public License as published by //
// the Free Software Foundation, either version 3 of the License, or    //
// (at your option) any later version.                                  //
//                                                                      //
// openPSTD is distributed in the hope that it will be useful,          //
// but WITHOUT ANY WARRANTY; without even the implied warranty of       //
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the        //
// GNU General Public License for more details.                         //
//                                                                      //
// You should have received a copy of the GNU General Public License    //
// along with openPSTD.  If not, see <http://www.gnu.org/licenses/>.    //
//                                                                      //
//////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////
//
// Date: 13-6-2016
//
//
// Authors: M. R. Fortuin
//
//
// Purpose:
//
//
//////////////////////////////////////////////////////////////////////////
#ifdef STAND_ALONE
#   define BOOST_TEST_MODULE Main
#endif

#include <boost/test/unit_test.hpp>
#include <kernel/DG/DG.h>
#include <kernel/DG/RK.h>
#include <kernel/DG/Maxwell.h>
#include <math.h>

using namespace OpenPSTD::Kernel;
using namespace OpenPSTD::Kernel::DG;
using namespace std;
using namespace Eigen;

BOOST_AUTO_TEST_SUITE(DG)
    BOOST_AUTO_TEST_SUITE(DG_Maxwell)

        BOOST_AUTO_TEST_CASE(DG_Maxwell_E_start)
        {
            int K = 80;
            int N = 6;
            MatrixX<double> EExpected(N+1,K);
            EExpected <<
                      0.000000000000000	,	-0.078459095727845	,	-0.156434465040231	,	-0.233445363855906	,	-0.309016994374948	,	-0.382683432365090	,	-0.453990499739547	,	-0.522498564715949	,	-0.587785252292473	,	-0.649448048330184	,	-0.707106781186548	,	-0.760405965600031	,	-0.809016994374947	,	-0.852640164354092	,	-0.891006524188368	,	-0.923879532511287	,	-0.951056516295154	,	-0.972369920397677	,	-0.987688340595138	,	-0.996917333733128	,	-1.000000000000000	,	-0.996917333733128	,	-0.987688340595138	,	-0.972369920397677	,	-0.951056516295154	,	-0.923879532511287	,	-0.891006524188368	,	-0.852640164354092	,	-0.809016994374947	,	-0.760405965600031	,	-0.707106781186547	,	-0.649448048330184	,	-0.587785252292473	,	-0.522498564715949	,	-0.453990499739547	,	-0.382683432365090	,	-0.309016994374947	,	-0.233445363855905	,	-0.156434465040231	,	-0.078459095727845	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,
                    -0.006667042610520	,	-0.085103842319525	,	-0.163015948540731	,	-0.239923007230879	,	-0.315350860798953	,	-0.388834471445399	,	-0.459920788274801	,	-0.528171540505308	,	-0.593165939553739	,	-0.654503273337131	,	-0.711805376795976	,	-0.764718963407566	,	-0.812917803314889	,	-0.856104734642175	,	-0.894013495596679	,	-0.926410366061175	,	-0.953095608556195	,	-0.973904699688016	,	-0.988709344490084	,	-0.997418267404151	,	-0.999977775024440	,	-0.996372087135350	,	-0.986623434001730	,	-0.970791919311905	,	-0.948975149618450	,	-0.921307632561338	,	-0.887959947583609	,	-0.849137694252381	,	-0.805080224669150	,	-0.756059167784493	,	-0.702376754715259	,	-0.644363955389233	,	-0.582378438005473	,	-0.516802363890928	,	-0.448040031348770	,	-0.376515383024918	,	-0.302669392160647	,	-0.226957343845919	,	-0.149846028035407	,	-0.071810861633195	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,
                    -0.020856746681015	,	-0.099234481157575	,	-0.177000402058986	,	-0.253675056623096	,	-0.328785720107609	,	-0.401869310295312	,	-0.472475242549938	,	-0.540168207820282	,	-0.604530856465257	,	-0.665166371353215	,	-0.721700914371517	,	-0.773785931262811	,	-0.821100300577938	,	-0.863352313496443	,	-0.900281472308466	,	-0.931660096469739	,	-0.957294726327856	,	-0.977027315865362	,	-0.990736207106007	,	-0.998336880176622	,	-0.999782474400249	,	-0.995064077207788	,	-0.984210779086958	,	-0.967289494229762	,	-0.944404547984242	,	-0.915697033654019	,	-0.881343942611157	,	-0.841557073085495	,	-0.796581724358137	,	-0.746695184409807	,	-0.692205020348246	,	-0.633447182154711	,	-0.570783931440629	,	-0.504601607984298	,	-0.435308247817682	,	-0.363331067548588	,	-0.289113830428216	,	-0.213114110403151	,	-0.135800471019817	,	-0.057649576574407	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,
                    -0.039259815759069	,	-0.117537397457838	,	-0.195090322016129	,	-0.271440449865074	,	-0.346117057077493	,	-0.418659737537428	,	-0.488621241496955	,	-0.555570233019602	,	-0.619093949309834	,	-0.678800745532942	,	-0.734322509435685	,	-0.785316930880745	,	-0.831469612302545	,	-0.872496007072797	,	-0.908143173825081	,	-0.938191335922484	,	-0.962455236453647	,	-0.980785280403230	,	-0.993068456954926	,	-0.999229036240723	,	-0.999229036240723	,	-0.993068456954926	,	-0.980785280403230	,	-0.962455236453647	,	-0.938191335922484	,	-0.908143173825081	,	-0.872496007072797	,	-0.831469612302545	,	-0.785316930880745	,	-0.734322509435686	,	-0.678800745532942	,	-0.619093949309834	,	-0.555570233019602	,	-0.488621241496955	,	-0.418659737537428	,	-0.346117057077493	,	-0.271440449865074	,	-0.195090322016128	,	-0.117537397457838	,	-0.039259815759069	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,
                    -0.057649576574407	,	-0.135800471019817	,	-0.213114110403151	,	-0.289113830428216	,	-0.363331067548588	,	-0.435308247817682	,	-0.504601607984298	,	-0.570783931440629	,	-0.633447182154711	,	-0.692205020348246	,	-0.746695184409808	,	-0.796581724358137	,	-0.841557073085495	,	-0.881343942611156	,	-0.915697033654019	,	-0.944404547984242	,	-0.967289494229762	,	-0.984210779086958	,	-0.995064077207788	,	-0.999782474400249	,	-0.998336880176622	,	-0.990736207106007	,	-0.977027315865362	,	-0.957294726327856	,	-0.931660096469739	,	-0.900281472308466	,	-0.863352313496443	,	-0.821100300577937	,	-0.773785931262811	,	-0.721700914371517	,	-0.665166371353215	,	-0.604530856465257	,	-0.540168207820282	,	-0.472475242549938	,	-0.401869310295312	,	-0.328785720107609	,	-0.253675056623096	,	-0.177000402058986	,	-0.099234481157575	,	-0.020856746681015	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,
                    -0.071810861633195	,	-0.149846028035406	,	-0.226957343845919	,	-0.302669392160647	,	-0.376515383024918	,	-0.448040031348770	,	-0.516802363890928	,	-0.582378438005473	,	-0.644363955389233	,	-0.702376754715259	,	-0.756059167784493	,	-0.805080224669150	,	-0.849137694252381	,	-0.887959947583609	,	-0.921307632561338	,	-0.948975149618450	,	-0.970791919311905	,	-0.986623434001730	,	-0.996372087135350	,	-0.999977775024440	,	-0.997418267404151	,	-0.988709344490084	,	-0.973904699688016	,	-0.953095608556196	,	-0.926410366061175	,	-0.894013495596679	,	-0.856104734642175	,	-0.812917803314889	,	-0.764718963407567	,	-0.711805376795976	,	-0.654503273337131	,	-0.593165939553739	,	-0.528171540505308	,	-0.459920788274801	,	-0.388834471445399	,	-0.315350860798953	,	-0.239923007230879	,	-0.163015948540731	,	-0.085103842319525	,	-0.006667042610521	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,
                    -0.078459095727845	,	-0.156434465040231	,	-0.233445363855906	,	-0.309016994374948	,	-0.382683432365090	,	-0.453990499739547	,	-0.522498564715949	,	-0.587785252292473	,	-0.649448048330184	,	-0.707106781186548	,	-0.760405965600031	,	-0.809016994374947	,	-0.852640164354092	,	-0.891006524188368	,	-0.923879532511287	,	-0.951056516295154	,	-0.972369920397677	,	-0.987688340595138	,	-0.996917333733128	,	-1.000000000000000	,	-0.996917333733128	,	-0.987688340595138	,	-0.972369920397677	,	-0.951056516295154	,	-0.923879532511287	,	-0.891006524188368	,	-0.852640164354092	,	-0.809016994374947	,	-0.760405965600031	,	-0.707106781186547	,	-0.649448048330184	,	-0.587785252292473	,	-0.522498564715949	,	-0.453990499739547	,	-0.382683432365090	,	-0.309016994374947	,	-0.233445363855905	,	-0.156434465040231	,	-0.078459095727845	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	;


            std::shared_ptr<MaxwellDE<double>> de = std::make_shared<MaxwellDE<double>>();
            std::shared_ptr<System1D<double, MaxwellDEElement<double>>> s = std::make_shared<System1D<double, MaxwellDEElement<double>>>(K, N, -1, 1, de);

            auto State = s->GetState();
            MatrixX<double> E = State[0];

            BOOST_CHECK(E.isApprox(EExpected));
        }

        BOOST_AUTO_TEST_CASE(DG_Maxwell_H_start)
        {
            int K = 80;
            int N = 6;
            MatrixX<double> HExpected = MatrixX<double>::Zero(N+1,K);

            std::shared_ptr<MaxwellDE<double>> de = std::make_shared<MaxwellDE<double>>();
            std::shared_ptr<System1D<double, MaxwellDEElement<double>>> s = std::make_shared<System1D<double, MaxwellDEElement<double>>>(K, N, -1, 1, de);

            auto State = s->GetState();
            MatrixX<double> H = State[1];

            BOOST_CHECK(H.isApprox(HExpected));
        }

        BOOST_AUTO_TEST_CASE(DG_Maxwell_Mu_start)
        {
            int K = 80;
            int N = 6;
            MatrixX<double> MuExpected = MatrixX<double>::Ones(N+1,K);

            std::shared_ptr<MaxwellDE<double>> de = std::make_shared<MaxwellDE<double>>();
            std::shared_ptr<System1D<double, MaxwellDEElement<double>>> s = std::make_shared<System1D<double, MaxwellDEElement<double>>>(K, N, -1, 1, de);

            for(int k = 0; k < K; k++)
            {
                std::shared_ptr<Element1D<double, MaxwellDEElement<double>>> element = s->Elements[k];
                BOOST_CHECK(element->DEStore.Mu.isApprox(MuExpected.col(k)));
            }
        }

        BOOST_AUTO_TEST_CASE(DG_Maxwell_Epsilon_start)
        {
            int K = 80;
            int N = 6;
            MatrixX<double> EpsExpected(N+1,K);
            EpsExpected << MatrixX<double>::Ones(N+1,K/2), 2*MatrixX<double>::Ones(N+1,K/2);

            std::shared_ptr<MaxwellDE<double>> de = std::make_shared<MaxwellDE<double>>();
            std::shared_ptr<System1D<double, MaxwellDEElement<double>>> s = std::make_shared<System1D<double, MaxwellDEElement<double>>>(K, N, -1, 1, de);

            for(int k = 0; k < K; k++)
            {
                std::shared_ptr<Element1D<double, MaxwellDEElement<double>>> element = s->Elements[k];
                BOOST_CHECK(element->DEStore.Eps.isApprox(EpsExpected.col(k)));
            }
        }

        BOOST_AUTO_TEST_CASE(DG_Maxwell_Zimp_start)
        {
            int K = 80;
            int N = 6;
            MatrixX<double> ZimpExpected(N+1,K);
            ZimpExpected << MatrixX<double>::Ones(N+1,K/2), MatrixX<double>::Constant(N+1,K/2,0.707106781186548);

            std::shared_ptr<MaxwellDE<double>> de = std::make_shared<MaxwellDE<double>>();
            std::shared_ptr<System1D<double, MaxwellDEElement<double>>> s = std::make_shared<System1D<double, MaxwellDEElement<double>>>(K, N, -1, 1, de);

            for(int k = 0; k < K; k++)
            {
                std::shared_ptr<Element1D<double, MaxwellDEElement<double>>> element = s->Elements[k];
                if(!element->DEStore.Zimp.isApprox(ZimpExpected.col(k)))
                {
                    std::cerr << element->DEStore.Zimp << std::endl;
                }
                BOOST_CHECK(element->DEStore.Zimp.isApprox(ZimpExpected.col(k)));
            }
        }

        BOOST_AUTO_TEST_CASE(DG_Maxwell_step_1_flux_E)
        {
            int K = 80;
            int N = 6;
            MatrixX<double> RHSEExpected = MatrixX<double>::Zero(N+1, K);

            RHSEExpected <<
                     0.240030772632896	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,
                    -0.014221839064916	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,
                     0.011387945645401	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,
                    -0.010715659492540	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,
                     0.011387945645401	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,
                    -0.014221839064916	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,
                     0.034290110376128	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	;

            RHSEExpected = RHSEExpected.array() * 1.0e-12;

            std::shared_ptr<MaxwellDE<double>> de = std::make_shared<MaxwellDE<double>>();
            std::shared_ptr<System1D<double, MaxwellDEElement<double>>> s = std::make_shared<System1D<double, MaxwellDEElement<double>>>(K, N, -1, 1, de);
            std::shared_ptr<LSERK<double>> RK = std::make_shared<LSERK<double>>();
            RK->SetBB(s);

            for(int k = 0; k < K; k++)
            {
                auto RHSList = de->CalculateRHS(s->Elements[k], s, 0);
                double distNorm = (RHSList[0]-RHSEExpected.col(k)).norm();
                BOOST_CHECK(distNorm < 1.0e-12);
                //Expected matrix is to small, the check is done with a precision around 1.0e-24 and this is not in the matlab output.
                //So the absolute distance is used.
            }
        }

        BOOST_AUTO_TEST_CASE(DG_Maxwell_step_1_flux_H)
        {
            int K = 80;
            int N = 6;
            MatrixX<double> RHSHExpected = MatrixX<double>::Zero(N+1, K);

            RHSHExpected <<
                        3.141592653590790	,	3.131908171893060	,	3.102914434850850	,	3.054790198493820	,	2.987832164742050	,	2.902453152140080	,	2.799179550691380	,	2.678648076491170	,	2.541601846158380	,	2.388885795275400	,	2.221441469079730	,	2.040301217522650	,	1.846581830490910	,	1.641477652423300	,	1.426253218781590	,	1.202235459769080	,	0.970805519362859	,	0.733390240104505	,	0.491453366138756	,	0.246486518745791	,	-0.000000000000084	,	-0.246486518746049	,	-0.491453366138954	,	-0.733390240104678	,	-0.970805519363086	,	-1.202235459769100	,	-1.426253218782040	,	-1.641477652423480	,	-1.846581830491230	,	-2.040301217523200	,	-2.221441469079910	,	-2.388885795275620	,	-2.541601846158480	,	-2.678648076491300	,	-2.799179550691680	,	-2.902453152140510	,	-2.987832164742600	,	-3.054790198494160	,	-3.102914434851070	,	-3.131908171893420	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,
                        3.141522831769710	,	3.130195229186220	,	3.099568932119100	,	3.049832761874320	,	2.981293358480320	,	2.894373290150870	,	2.789608448010530	,	2.667644742149380	,	2.529234119370830	,	2.375229927190720	,	2.206581652665620	,	2.024329068488800	,	1.829595822447040	,	1.623582509757450	,	1.407559270999340	,	1.182857961274640	,	0.950863938878377	,	0.713007524104598	,	0.470755180845691	,	0.225600475354854	,	-0.020945132086302	,	-0.267361605823183	,	-0.512129706353374	,	-0.753740356943550	,	-0.990703947589034	,	-1.221559518955110	,	-1.444883769677080	,	-1.659299831486420	,	-1.863485758061370	,	-2.056182675266110	,	-2.236202542527600	,	-2.402435477501670	,	-2.553856598865980	,	-2.689532345054900	,	-2.808626229976220	,	-2.910404000226770	,	-2.994238162008380	,	-3.059611849835990	,	-3.106122013185170	,	-3.133481901432680	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,
                        3.140909276764040	,	3.126085994807430	,	3.091989353163920	,	3.038829568967220	,	2.966934389964510	,	2.876747073841780	,	2.768823655393460	,	2.643829518382210	,	2.502535293227750	,	2.345812105813040	,	2.174626206704280	,	1.990033013894600	,	1.793170605801180	,	1.585252704633290	,	1.367561193391240	,	1.141438212631670	,	0.908277885724622	,	0.669517723618967	,	0.426629762109945	,	0.181111486248726	,	-0.065523402150869	,	-0.311754316987476	,	-0.556063162791006	,	-0.796943694286167	,	-1.032910802895420	,	-1.262509672927110	,	-1.484324750998090	,	-1.696988473391160	,	-1.899189697539850	,	-2.089681785658480	,	-2.267290290678870	,	-2.430920197106680	,	-2.579562672156330	,	-2.712301285540490	,	-2.828317659567620	,	-2.926896514712440	,	-3.007430079552190	,	-3.069421837879520	,	-3.112489589890010	,	-3.136367808570990	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,
                        3.139170599507100	,	3.119816568881020	,	3.081227831663470	,	3.023642300251470	,	2.947415008595310	,	2.853015923296270	,	2.741027046106040	,	2.612138825692540	,	2.467145900794360	,	2.306942201008520	,	2.132515435417380	,	1.944941003033470	,	1.745375362607340	,	1.535048902674580	,	1.315258355801250	,	1.087358803796620	,	0.852755323183095	,	0.612894322432275	,	0.369254624375560	,	0.123338348770008	,	-0.123338348769976	,	-0.369254624375551	,	-0.612894322432256	,	-0.852755323183153	,	-1.087358803796630	,	-1.315258355801280	,	-1.535048902674590	,	-1.745375362607340	,	-1.944941003033450	,	-2.132515435417300	,	-2.306942201008510	,	-2.467145900794340	,	-2.612138825692530	,	-2.741027046106010	,	-2.853015923296280	,	-2.947415008595350	,	-3.023642300251470	,	-3.081227831663450	,	-3.119816568881000	,	-3.139170599507110	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,
                        3.136367808571040	,	3.112489589889900	,	3.069421837879600	,	3.007430079552170	,	2.926896514712400	,	2.828317659567670	,	2.712301285540520	,	2.579562672156370	,	2.430920197106730	,	2.267290290678860	,	2.089681785658510	,	1.899189697539830	,	1.696988473391120	,	1.484324750998130	,	1.262509672927150	,	1.032910802895440	,	0.796943694286212	,	0.556063162791060	,	0.311754316987483	,	0.065523402150910	,	-0.181111486248691	,	-0.426629762109955	,	-0.669517723618924	,	-0.908277885724569	,	-1.141438212631710	,	-1.367561193391220	,	-1.585252704633210	,	-1.793170605801170	,	-1.990033013894590	,	-2.174626206704280	,	-2.345812105813000	,	-2.502535293227690	,	-2.643829518382220	,	-2.768823655393380	,	-2.876747073841770	,	-2.966934389964420	,	-3.038829568967160	,	-3.091989353163830	,	-3.126085994807460	,	-3.140909276764010	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,
                        3.133481901432710	,	3.106122013185160	,	3.059611849836240	,	2.994238162008590	,	2.910404000226920	,	2.808626229976190	,	2.689532345054980	,	2.553856598866110	,	2.402435477501870	,	2.236202542527780	,	2.056182675266090	,	1.863485758061430	,	1.659299831486530	,	1.444883769677210	,	1.221559518955210	,	0.990703947589167	,	0.753740356943682	,	0.512129706353452	,	0.267361605823286	,	0.020945132086397	,	-0.225600475354751	,	-0.470755180845554	,	-0.713007524104443	,	-0.950863938878233	,	-1.182857961274450	,	-1.407559270999230	,	-1.623582509757410	,	-1.829595822446820	,	-2.024329068488590	,	-2.206581652665390	,	-2.375229927190630	,	-2.529234119370650	,	-2.667644742149090	,	-2.789608448010210	,	-2.894373290150460	,	-2.981293358480150	,	-3.049832761874170	,	-3.099568932118910	,	-3.130195229185880	,	-3.141522831769380	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,
                        3.131908171894030	,	3.102914434851070	,	3.054790198494750	,	2.987832164742930	,	2.902453152140220	,	2.799179550692240	,	2.678648076491380	,	2.541601846158840	,	2.388885795275620	,	2.221441469080130	,	2.040301217523140	,	1.846581830491210	,	1.641477652423680	,	1.426253218781970	,	1.202235459769190	,	0.970805519363282	,	0.733390240104696	,	0.491453366138996	,	0.246486518746117	,	0.000000000000142	,	-0.246486518745851	,	-0.491453366138784	,	-0.733390240104308	,	-0.970805519363140	,	-1.202235459769010	,	-1.426253218781590	,	-1.641477652423160	,	-1.846581830490980	,	-2.040301217522930	,	-2.221441469079900	,	-2.388885795275650	,	-2.541601846158520	,	-2.678648076491310	,	-2.799179550691790	,	-2.902453152140500	,	-2.987832164742650	,	-3.054790198494070	,	-3.102914434851020	,	-3.131908171893420	,	-3.141592653590900	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	;



            std::shared_ptr<MaxwellDE<double>> de = std::make_shared<MaxwellDE<double>>();
            std::shared_ptr<System1D<double, MaxwellDEElement<double>>> s = std::make_shared<System1D<double, MaxwellDEElement<double>>>(K, N, -1, 1, de);
            std::shared_ptr<LSERK<double>> RK = std::make_shared<LSERK<double>>();
            RK->SetBB(s);

            for(int k = 0; k < K; k++)
            {
                auto RHSList = de->CalculateRHS(s->Elements[k], s, 0);
                BOOST_CHECK(RHSList[1].isApprox(RHSHExpected.col(k), 1e-10));
                //entries arround 0 are a little bit to small to use 1e-12, so 1e-10 is used
            }
        }

        BOOST_AUTO_TEST_CASE(DG_Maxwell_1_E)
        {
            int K = 80;
            int N = 6;
            MatrixX<double> EExpected = MatrixX<double>::Zero(N+1, K);
            EExpected <<
                      0.000000000000012	,	-0.074619034254633	,	-0.148778017349757	,	-0.222019734494202	,	-0.293892626146426	,	-0.363953572029286	,	-0.431770623113732	,	-0.496925664728256	,	-0.559016994375344	,	-0.617661798360304	,	-0.672498511964314	,	-0.723189048613641	,	-0.769420884295252	,	-0.810908984365427	,	-0.847397560889084	,	-0.878661649666690	,	-0.904508497193906	,	-0.924778749043401	,	-0.939347432381574	,	-0.948124726460125	,	-0.951056516313979	,	-0.948124726443031	,	-0.939347432364397	,	-0.924778749064173	,	-0.904508497222980	,	-0.878661649643708	,	-0.847397560853257	,	-0.810908984054206	,	-0.769420886765891	,	-0.723189045170438	,	-0.672498453953827	,	-0.617661928842152	,	-0.559018395161280	,	-0.496929966366043	,	-0.431785051983155	,	-0.364050627176871	,	-0.294890693558485	,	-0.254519991312262	,	-0.213575124190320	,	-0.171315270852790	,	-0.127998996810160	,	-0.083545175154796	,	-0.038047925251840	,	0.000663196213843	,	0.000055626307368	,	0.000022528277171	,	0.000011675788392	,	0.000000393867259	,	-0.000000622019286	,	0.000000108215214	,	-0.000000009071380	,	-0.000000000030655	,	0.000000000139059	,	-0.000000000019272	,	-0.000000000001568	,	0.000000000001517	,	-0.000000000000455	,	0.000000000000090	,	-0.000000000000012	,	0.000000000000001	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,
                    -0.006340734319155	,	-0.080938563799786	,	-0.155037380119789	,	-0.228180339436190	,	-0.299916491082310	,	-0.369803557828547	,	-0.437410662668602	,	-0.502320985319528	,	-0.564134332057270	,	-0.622469603044105	,	-0.676967141936116	,	-0.727290953283797	,	-0.773130774055361	,	-0.814203986512727	,	-0.850257360643793	,	-0.881068615406911	,	-0.906447789169303	,	-0.926238410888409	,	-0.940318464801661	,	-0.948601142688167	,	-0.951035379084183	,	-0.947606166123913	,	-0.938334646043353	,	-0.923277980830532	,	-0.902528999838315	,	-0.876215627467853	,	-0.844500094299269	,	-0.807577937649342	,	-0.765676794144679	,	-0.719054986148410	,	-0.668000017161581	,	-0.612826834835361	,	-0.553875016566426	,	-0.491505174444945	,	-0.426096751830764	,	-0.358111545725460	,	-0.290682105123193	,	-0.251109252354068	,	-0.210035313564487	,	-0.167675551485498	,	-0.124279067930099	,	-0.079715575379213	,	-0.034127690347625	,	0.000287593963204	,	0.000104411903203	,	0.000021074816194	,	-0.000000012433909	,	-0.000001226670321	,	0.000000084938837	,	0.000000024533247	,	-0.000000008255495	,	0.000000001640042	,	-0.000000000282191	,	0.000000000046265	,	-0.000000000007162	,	0.000000000000967	,	-0.000000000000094	,	0.000000000000001	,	0.000000000000002	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,
                    -0.019835944839709	,	-0.094377599946140	,	-0.168337385765168	,	-0.241259315623091	,	-0.312693801573332	,	-0.382200426255637	,	-0.449350658215543	,	-0.513730493943269	,	-0.574943010343124	,	-0.632610811896319	,	-0.686378357429638	,	-0.735914152145368	,	-0.780912791397133	,	-0.821096843610044	,	-0.856218560739006	,	-0.886061405719931	,	-0.910441387490516	,	-0.929208195353158	,	-0.942246125696574	,	-0.949474795350039	,	-0.950849637159828	,	-0.946362174760325	,	-0.936040074854209	,	-0.919946976631815	,	-0.898182099387668	,	-0.870879630799681	,	-0.838207899761483	,	-0.800368338079143	,	-0.757594238570154	,	-0.710149331103881	,	-0.658326101790211	,	-0.602443805288577	,	-0.542846810837038	,	-0.479903118629143	,	-0.413994490231152	,	-0.345419993796059	,	-0.283394867619532	,	-0.243790643399537	,	-0.202469919427259	,	-0.159903654014705	,	-0.116324542047547	,	-0.071542701157047	,	-0.025958217557714	,	-0.000289438379161	,	-0.000047038640657	,	-0.000011952742947	,	-0.000001686425688	,	0.000000421454520	,	0.000000024606787	,	-0.000000017444999	,	0.000000003673909	,	-0.000000000609250	,	0.000000000097881	,	-0.000000000016209	,	0.000000000002666	,	-0.000000000000397	,	0.000000000000046	,	-0.000000000000003	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,
                    -0.037338303606232	,	-0.111784707760718	,	-0.185541922019671	,	-0.258155208630422	,	-0.329176882534654	,	-0.398169071495630	,	-0.464706415726181	,	-0.528378690373239	,	-0.588793334690386	,	-0.645577872305460	,	-0.698382207661440	,	-0.746880784471601	,	-0.790774592882129	,	-0.829793012968358	,	-0.863695483196141	,	-0.892272983561599	,	-0.915349324271323	,	-0.932782232014030	,	-0.944464227116488	,	-0.950323286188843	,	-0.950323286185446	,	-0.944464227114893	,	-0.932782232019403	,	-0.915349324271709	,	-0.892272983553238	,	-0.863695483206534	,	-0.829793012923741	,	-0.790774592971889	,	-0.746880785898236	,	-0.698382196956362	,	-0.645577853990150	,	-0.588793603368516	,	-0.528380041017754	,	-0.464710608974279	,	-0.398193304231973	,	-0.329345954381201	,	-0.274525552830527	,	-0.234224563652081	,	-0.192593776310008	,	-0.149772619450324	,	-0.105935073346592	,	-0.060893763815807	,	-0.015020757019004	,	0.000144337886807	,	0.000016743939639	,	0.000006443500260	,	0.000001296579762	,	-0.000000222857935	,	-0.000000022055290	,	0.000000011232139	,	-0.000000002301261	,	0.000000000385684	,	-0.000000000063257	,	0.000000000010617	,	-0.000000000001741	,	0.000000000000253	,	-0.000000000000028	,	0.000000000000001	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,
                    -0.054828005462779	,	-0.129153922879429	,	-0.202683563413490	,	-0.274963592379980	,	-0.345548379364774	,	-0.414002745684293	,	-0.479904647406789	,	-0.542847777393504	,	-0.602444070317407	,	-0.658326095214882	,	-0.710149320819601	,	-0.757594239712786	,	-0.800368338192852	,	-0.838207899718393	,	-0.870879630808957	,	-0.898182099379387	,	-0.919946976632683	,	-0.936040074859582	,	-0.946362174758153	,	-0.950849637156502	,	-0.949474795354176	,	-0.942246125697915	,	-0.929208195346731	,	-0.910441387490456	,	-0.886061405730483	,	-0.856218560721748	,	-0.821096843683630	,	-0.780912791307582	,	-0.735914149480651	,	-0.686378373509447	,	-0.632610862079561	,	-0.574942657365637	,	-0.513728076732003	,	-0.449340665546649	,	-0.382147622862733	,	-0.312505572613852	,	-0.265095223012326	,	-0.224589507449249	,	-0.182652342374100	,	-0.139590814407198	,	-0.095473650312536	,	-0.050218474211125	,	-0.004335945323036	,	-0.000050295859711	,	-0.000002999916608	,	-0.000004538120352	,	-0.000001325489958	,	0.000000172714145	,	0.000000026478173	,	-0.000000011049161	,	0.000000002211170	,	-0.000000000371760	,	0.000000000061701	,	-0.000000000010471	,	0.000000000001725	,	-0.000000000000250	,	0.000000000000027	,	-0.000000000000001	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,
                    -0.068296187897061	,	-0.142512041404107	,	-0.215849260785830	,	-0.287855697697647	,	-0.358087408511433	,	-0.426111391375584	,	-0.491508255815485	,	-0.553874808415250	,	-0.612826538639032	,	-0.667999989466499	,	-0.719054998226571	,	-0.765676793812632	,	-0.807577937350849	,	-0.844500094358555	,	-0.876215627461126	,	-0.902528999847941	,	-0.923277980827004	,	-0.938334646036764	,	-0.947606166128936	,	-0.951035379088038	,	-0.948601142680517	,	-0.940318464800640	,	-0.926238410899555	,	-0.906447789169144	,	-0.881068615385834	,	-0.850257360683891	,	-0.814203986422875	,	-0.773130773443156	,	-0.727290961499287	,	-0.676967126765772	,	-0.622469392672403	,	-0.564134359947552	,	-0.502324722104420	,	-0.437430507491728	,	-0.369866322254775	,	-0.299805802324435	,	-0.257936557106204	,	-0.217104593474629	,	-0.174947384159569	,	-0.131710501521722	,	-0.087365782647183	,	-0.041937971965798	,	0.000170775065688	,	-0.000075313122265	,	-0.000019716456317	,	0.000000643784727	,	0.000001694339141	,	-0.000000029752991	,	-0.000000060413473	,	0.000000015049055	,	-0.000000002515458	,	0.000000000387482	,	-0.000000000064083	,	0.000000000011621	,	-0.000000000002116	,	0.000000000000344	,	-0.000000000000044	,	0.000000000000003	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,
                    -0.074619034254654	,	-0.148778017349766	,	-0.222019734494215	,	-0.293892626146453	,	-0.363953572029233	,	-0.431770623113678	,	-0.496925664728403	,	-0.559016994375206	,	-0.617661798359781	,	-0.672498511964912	,	-0.723189048614270	,	-0.769420884292810	,	-0.810908984365079	,	-0.847397560894808	,	-0.878661649663934	,	-0.904508497182159	,	-0.924778749053919	,	-0.939347432401196	,	-0.948124726434000	,	-0.951056516285615	,	-0.948124726494696	,	-0.939347432403440	,	-0.924778748982647	,	-0.904508497175225	,	-0.878661649756791	,	-0.847397560945587	,	-0.810908983674423	,	-0.769420887847522	,	-0.723189045570667	,	-0.672498419357718	,	-0.617661995244293	,	-0.559019113130039	,	-0.496931173734440	,	-0.431784646487770	,	-0.364057046712921	,	-0.295002779095993	,	-0.254462427661441	,	-0.213577296277553	,	-0.171315253314695	,	-0.127999029949904	,	-0.083544468054746	,	-0.038033456067544	,	0.000597466845151	,	0.000065504533642	,	0.000018079562688	,	0.000007477730012	,	0.000000359401098	,	-0.000000399173459	,	0.000000057269940	,	-0.000000001680126	,	-0.000000000963751	,	0.000000000279033	,	-0.000000000049020	,	0.000000000005690	,	-0.000000000000095	,	-0.000000000000165	,	0.000000000000052	,	-0.000000000000010	,	0.000000000000001	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	;


            std::shared_ptr<MaxwellDE<double>> de = std::make_shared<MaxwellDE<double>>();
            std::shared_ptr<System1D<double, MaxwellDEElement<double>>> s = std::make_shared<System1D<double, MaxwellDEElement<double>>>(K, N, -1, 1, de);
            std::shared_ptr<LSERK<double>> RK = std::make_shared<LSERK<double>>();
            RK->SetBB(s);
            RK->Calculate(0.1);

            auto State = s->GetState();
            MatrixX<double> E = State[0];
            BOOST_CHECK(E.isApprox(EExpected));
        }

        BOOST_AUTO_TEST_CASE(DG_Maxwell_1_H)
        {
            int K = 80;
            int N = 6;
            MatrixX<double> HExpected = MatrixX<double>::Zero(N+1, K);
            HExpected <<
                    0.309016994373120	,	0.308064398108670	,	0.305212482388079	,	0.300478830220109	,	0.293892626144465	,	0.285494476299466	,	0.275336158071523	,	0.263480300870377	,	0.249999999998438	,	0.234978365993276	,	0.218508012222857	,	0.200690483895817	,	0.181635632000946	,	0.161460936033465	,	0.140290779700823	,	0.118255684065028	,	0.095491502817438	,	0.072138584687937	,	0.048340908192039	,	0.024245193947950	,	0.000000000018313	,	-0.024245193954669	,	-0.048340908230152	,	-0.072138584667653	,	-0.095491502774959	,	-0.118255684086627	,	-0.140290779738565	,	-0.161460936340111	,	-0.181635629526392	,	-0.200690487339180	,	-0.218508070235318	,	-0.234978235515525	,	-0.249998599218827	,	-0.263475999241239	,	-0.275321729212046	,	-0.285397421153857	,	-0.292894558723778	,	-0.267978573397358	,	-0.240415375535518	,	-0.211368161466953	,	-0.181017917259078	,	-0.118150719774748	,	-0.053807891911311	,	0.000937901080131	,	0.000078667478305	,	0.000031859795111	,	0.000016512058295	,	0.000000557012420	,	-0.000000879668110	,	0.000000153039423	,	-0.000000012828869	,	-0.000000000043353	,	0.000000000196659	,	-0.000000000027255	,	-0.000000000002218	,	0.000000000002145	,	-0.000000000000644	,	0.000000000000127	,	-0.000000000000017	,	0.000000000000001	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,
                    0.309010126477978	,	0.307895907643844	,	0.304883408153307	,	0.299991201067485	,	0.293249448469888	,	0.284699715507132	,	0.274394714126006	,	0.262397978086819	,	0.248783471256536	,	0.233635131596985	,	0.217046353659666	,	0.199119412776923	,	0.179964834500152	,	0.159700713174233	,	0.138451983846571	,	0.116349651998226	,	0.093529985853428	,	0.070133676245386	,	0.046304969204273	,	0.022190776626416	,	-0.002060229472467	,	-0.026298533564457	,	-0.050374698447011	,	-0.074140286573855	,	-0.097448775186349	,	-0.120156459667734	,	-0.142123339702710	,	-0.163213981662772	,	-0.183298355473864	,	-0.202252646412780	,	-0.219959930421368	,	-0.236310859415652	,	-0.251205208100756	,	-0.264553993336787	,	-0.276280002880801	,	-0.286252409660821	,	-0.291696332881216	,	-0.265693111535287	,	-0.238004717783760	,	-0.208839831546033	,	-0.175757143385833	,	-0.112734847833658	,	-0.048263842542081	,	0.000406719283220	,	0.000147660729583	,	0.000029804290885	,	-0.000000017584203	,	-0.000001734773804	,	0.000000120121655	,	0.000000034695251	,	-0.000000011675033	,	0.000000002319369	,	-0.000000000399078	,	0.000000000065428	,	-0.000000000010128	,	0.000000000001368	,	-0.000000000000133	,	0.000000000000002	,	0.000000000000003	,	-0.000000000000001	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,
                    0.308949775266089	,	0.307491710347415	,	0.304137856783081	,	0.298908892195578	,	0.291837054890393	,	0.282965945096146	,	0.272350256154661	,	0.260055437318306	,	0.246157290233690	,	0.230741501599235	,	0.213903114877990	,	0.195745944323447	,	0.176381934930317	,	0.155930472255359	,	0.134517646366115	,	0.112275474455852	,	0.089341086911423	,	0.065855881855681	,	0.041964653387204	,	0.017814698879536	,	-0.006445089168639	,	-0.030665141105478	,	-0.054696132252050	,	-0.078389903544851	,	-0.101600375012398	,	-0.124184446407684	,	-0.146002879324811	,	-0.166921156149748	,	-0.186810309413056	,	-0.205547702549018	,	-0.223017840819899	,	-0.239113267796062	,	-0.253734913520380	,	-0.266792065780208	,	-0.278210530117005	,	-0.288027188357982	,	-0.287389063819213	,	-0.260810964583088	,	-0.232838328388065	,	-0.203427413527298	,	-0.164507745000480	,	-0.101176658265101	,	-0.036710463325150	,	-0.000409327681281	,	-0.000066522683573	,	-0.000016903731184	,	-0.000002384966080	,	0.000000596026698	,	0.000000034799252	,	-0.000000024670954	,	0.000000005195692	,	-0.000000000861609	,	0.000000000138425	,	-0.000000000022923	,	0.000000000003771	,	-0.000000000000561	,	0.000000000000065	,	-0.000000000000004	,	-0.000000000000001	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,
                    0.308778753469462	,	0.306875029774969	,	0.303079319475609	,	0.297415024387582	,	0.289917066773677	,	0.280631674035898	,	0.269616093708186	,	0.256938240506335	,	0.242676277611113	,	0.226918134766313	,	0.209760966162839	,	0.191310551450435	,	0.171680643570826	,	0.150992267434051	,	0.129372973759201	,	0.106956052679722	,	0.083879711967774	,	0.060286224940363	,	0.036321053290674	,	0.012131950265762	,	-0.012131950268665	,	-0.036321053288675	,	-0.060286224935747	,	-0.083879711969136	,	-0.106956052687518	,	-0.129372973748349	,	-0.150992267479367	,	-0.171680643481532	,	-0.191310550023885	,	-0.209760976868166	,	-0.226918153081782	,	-0.242676008932770	,	-0.256936889861403	,	-0.269611900459404	,	-0.280607441298499	,	-0.289747994926498	,	-0.281044680187779	,	-0.254396677843248	,	-0.226065961226255	,	-0.196344437629301	,	-0.149814817457738	,	-0.086116786652258	,	-0.021242558293387	,	0.000204124597087	,	0.000023679506526	,	0.000009112485457	,	0.000001833640685	,	-0.000000315168714	,	-0.000000031190891	,	0.000000015884644	,	-0.000000003254475	,	0.000000000545440	,	-0.000000000089459	,	0.000000000015015	,	-0.000000000002463	,	0.000000000000358	,	-0.000000000000039	,	0.000000000000002	,	0.000000000000001	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,
                    0.308503062084021	,	0.306154324936525	,	0.301918044569154	,	0.295820339059076	,	0.287898802788448	,	0.278202274662571	,	0.266790537001758	,	0.253733946963444	,	0.239113002767023	,	0.223017847395462	,	0.205547712833632	,	0.186810308270561	,	0.166921156036632	,	0.146002879368734	,	0.124184446397839	,	0.101600375020052	,	0.078389903546107	,	0.054696132247472	,	0.030665141103315	,	0.006445089171588	,	-0.017814698876102	,	-0.041964653389388	,	-0.065855881861216	,	-0.089341086909750	,	-0.112275474445884	,	-0.134517646383784	,	-0.155930472181043	,	-0.176381935019405	,	-0.195745946988084	,	-0.213903098797947	,	-0.230741451415870	,	-0.246157643211431	,	-0.260057854530024	,	-0.272360248824256	,	-0.283018748490072	,	-0.292025283850411	,	-0.275072984805953	,	-0.247885735098837	,	-0.219216967918704	,	-0.189194905694694	,	-0.135020131121255	,	-0.071019647311056	,	-0.006131952681545	,	-0.000071129086935	,	-0.000004242522753	,	-0.000006417871349	,	-0.000001874525876	,	0.000000244254687	,	0.000000037445791	,	-0.000000015625874	,	0.000000003127067	,	-0.000000000525748	,	0.000000000087259	,	-0.000000000014808	,	0.000000000002440	,	-0.000000000000353	,	0.000000000000038	,	-0.000000000000001	,	-0.000000000000001	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,
                    0.308219195126081	,	0.305527989942949	,	0.300953103103452	,	0.294522740306261	,	0.286276546876339	,	0.276265363338300	,	0.264550911967720	,	0.251205416252802	,	0.236311155612371	,	0.219959958116053	,	0.202252634334046	,	0.183298355805650	,	0.163213981960209	,	0.142123339641999	,	0.120156459675453	,	0.097448775177737	,	0.074140286573699	,	0.050374698452363	,	0.026298533566938	,	0.002060229469053	,	-0.022190776631808	,	-0.046304969201412	,	-0.070133676236036	,	-0.093529985855474	,	-0.116349652018445	,	-0.138451983806272	,	-0.159700713265147	,	-0.179964835112916	,	-0.199119404561559	,	-0.217046368830256	,	-0.233635341968637	,	-0.248783443365669	,	-0.262394241301025	,	-0.274374869301626	,	-0.284636951079535	,	-0.293360137227375	,	-0.270234983398171	,	-0.242816194799162	,	-0.213887087286463	,	-0.183640359280611	,	-0.123553874706987	,	-0.059309248732454	,	0.000241512414011	,	-0.000106508838932	,	-0.000027883279926	,	0.000000910449093	,	0.000002396157392	,	-0.000000042077083	,	-0.000000085437553	,	0.000000021282577	,	-0.000000003557394	,	0.000000000547982	,	-0.000000000090627	,	0.000000000016435	,	-0.000000000002992	,	0.000000000000487	,	-0.000000000000062	,	0.000000000000004	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,
                    0.308064398108677	,	0.305212482388078	,	0.300478830220124	,	0.293892626144507	,	0.285494476299444	,	0.275336158071520	,	0.263480300870598	,	0.249999999998396	,	0.234978365992876	,	0.218508012223607	,	0.200690483896625	,	0.181635631998709	,	0.161460936033339	,	0.140290779706776	,	0.118255684062488	,	0.095491502805860	,	0.072138584698530	,	0.048340908211581	,	0.024245193921509	,	-0.000000000010696	,	-0.024245193904077	,	-0.048340908192698	,	-0.072138584751312	,	-0.095491502825333	,	-0.118255683976490	,	-0.140290779649119	,	-0.161460936722060	,	-0.181635628445620	,	-0.200690486937780	,	-0.218508104827051	,	-0.234978169106178	,	-0.249997881242217	,	-0.263474791863779	,	-0.275322134698962	,	-0.285391001622078	,	-0.292782473202076	,	-0.268036137054779	,	-0.240413203465006	,	-0.211368179055454	,	-0.181017964401775	,	-0.118149719784267	,	-0.053787429394642	,	0.000844945715481	,	0.000092637399874	,	0.000025568362755	,	0.000010575107199	,	0.000000508269907	,	-0.000000564516520	,	0.000000080991925	,	-0.000000002376057	,	-0.000000001362949	,	0.000000000394612	,	-0.000000000069325	,	0.000000000008047	,	-0.000000000000135	,	-0.000000000000234	,	0.000000000000074	,	-0.000000000000013	,	0.000000000000001	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	,	0.000000000000000	;


            std::shared_ptr<MaxwellDE<double>> de = std::make_shared<MaxwellDE<double>>();
            std::shared_ptr<System1D<double, MaxwellDEElement<double>>> s = std::make_shared<System1D<double, MaxwellDEElement<double>>>(K, N, -1, 1, de);
            std::shared_ptr<LSERK<double>> RK = std::make_shared<LSERK<double>>();
            RK->SetBB(s);
            RK->Calculate(0.1);

            auto State = s->GetState();
            MatrixX<double> H = State[1];

            BOOST_CHECK(H.isApprox(HExpected));
        }
    BOOST_AUTO_TEST_SUITE_END()
BOOST_AUTO_TEST_SUITE_END()